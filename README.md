# saudi_geo_clickhouse

Saudi Arabia polygon data is uploaded in this repository.
District and City Polygon are easiy available online.

I have uploaded sample SQL create statment on clikchouse with polygon values.

I believe it is hard to figure how to create table and insert query into CH especially Polygon values.

#Details on SQL statment
The poly column is loaded in order to execute pointInPolygon() CH function.

Data Loaded into this table is in format which is used for Apache superset deck.gl polygon, so feel free to change the format as required. 

--Clickhouse Query 

#CREATE
```
CREATE TABLE ksa_city
(

    `id` Int,
	`name_en` String,
    `poly` Array(Tuple(Float64,Float64)),
    `gjson` String
)
engine = MergeTree() order by (id, name_en);

```

#INSERT
```
insert into ksa_city (id,name_en,gjson,poly) values
(0,'Al Bahah','[[41.41254996,20.15287002], [41.40988992,20.15337006], [41.40722016,20.15420004], [41.40471996,20.15437005], [41.40239004,20.15454006], [41.40038988,20.1538701], [41.39906004,20.1527001], [41.39688996,20.15104005], [41.39538984,20.1493701], [41.39456004,20.1472101], [41.39355996,20.14504002], [41.39173008,20.14288002], [41.39006004,20.14038009], [41.38723008,20.1382101], [41.38522992,20.13788007], [41.38356996,20.13855003], [41.38157016,20.1382101], [41.38057008,20.13738003], [41.37990012,20.13505002], [41.37923988,20.1327201], [41.37890796,20.13159798], [41.3789454,20.13148368], [41.38103916,20.1272958], [41.38180056,20.12596335], [41.3835138,20.12272722], [41.38636932,20.11930083], [41.38674984,20.11587435], [41.38789212,20.11073472], [41.39169912,20.10635658], [41.39227044,20.10864087], [41.39417376,20.10597588], [41.39569656,20.1029301], [41.39855208,20.10369159], [41.39969436,20.1029301], [41.40312048,20.1021687], [41.40616644,20.10007476], [41.40711792,20.09683872], [41.40921204,20.09474478], [41.40997344,20.09284119], [41.40997344,20.0901762], [41.41092528,20.08827261], [41.41149624,20.08503657], [41.41187712,20.08161018], [41.41187712,20.07951624], [41.41339992,20.07647055], [41.42025288,20.07152127], [41.42405988,20.06143236], [41.42581884,20.05027875], [41.42650392,20.04685425], [41.42855844,20.04034761], [41.4289008,20.03452587], [41.42650392,20.02973157], [41.42444904,20.02630707], [41.42273688,20.02082778], [41.42273688,20.01534858], [41.42444904,20.01021174], [41.42650392,20.00815704], [41.42684628,20.00541744], [41.42684628,20.0035701], [41.42703996,20.0035701], [41.43195,20.00291004], [41.43552012,20.00157003], [41.43731004,19.99912005], [41.43819996,19.99645002], [41.43863988,19.99310004], [41.43708,19.99108008], [41.43417984,19.98885006], [41.43395988,19.98617004], [41.4346302,19.98304002], [41.43574008,19.97925003], [41.43753,19.97615007], [41.44020012,19.97731008], [41.44303008,19.97748009], [41.44552992,19.97731008], [41.44853016,19.97698005], [41.45069016,19.9764801], [41.45203008,19.97548002], [41.4535302,19.97482005], [41.45436,19.97348004], [41.45486004,19.97132004], [41.4556902,19.96915005], [41.45685984,19.96733007], [41.45851008,19.96565004], [41.4601902,19.96500006], [41.46168996,19.96399008], [41.46351984,19.96299009], [41.46518016,19.96249005], [41.46701004,19.96116003], [41.46778008,19.96083009], [41.46890004,19.96018002], [41.47259004,19.95922008], [41.47819992,19.9579401], [41.48188992,19.95699006], [41.48525988,19.95537006], [41.48733996,19.95361002], [41.48766,19.95105006], [41.48686008,19.94832009], [41.48510004,19.94495004], [41.48300988,19.94239008], [41.4798102,19.93934007], [41.47692012,19.93726008], [41.47338996,19.93421007], [41.46954012,19.93100004], [41.46666012,19.92780009], [41.46297012,19.92571002], [41.46008004,19.92427002], [41.45720004,19.92299004], [41.45463,19.92186009], [41.45286996,19.92010005], [41.45253984,19.91850003], [41.45303016,19.91721006], [41.45469012,19.91602008], [41.45769,19.91419002], [41.46035004,19.91287008], [41.46351984,19.91052009], [41.46535008,19.90936008], [41.46834996,19.90769004], [41.47050996,19.9061901], [41.47418016,19.90336005], [41.47700004,19.90120005], [41.47967988,19.89853002], [41.4858402,19.89403002], [41.48799984,19.8928701], [41.49117,19.89187002], [41.4946602,19.89104004], [41.49716004,19.89070002], [41.50000008,19.89070002], [41.50216008,19.89087003], [41.50365012,19.89054009], [41.50566,19.89353007], [41.50748988,19.8962001], [41.50949004,19.89853002], [41.51181996,19.90103004], [41.51414988,19.90370007], [41.51615004,19.90586007], [41.51765016,19.90769004], [41.51998008,19.91119005], [41.52165012,19.91520009], [41.52264984,19.9175301], [41.52348,19.92018006], [41.52381984,19.92268008], [41.52414996,19.92535002], [41.52447,19.92818007], [41.52431016,19.93101003], [41.52447,19.93284009], [41.52565008,19.94484006], [41.52647988,19.94733009], [41.52831012,19.94967009], [41.52980988,19.95216003], [41.53131,19.95366006], [41.53281012,19.95616008], [41.53480992,19.95916005], [41.53763988,19.96182009], [41.54014008,19.96416009], [41.54196996,19.96599006], [41.54447016,19.96799004], [41.54730012,19.96966008], [41.55013008,19.97132004], [41.55296004,19.97332002], [41.55629004,19.97465004], [41.55861996,19.9764801], [41.56029,19.97815005], [41.56194996,19.9798101], [41.56462008,19.98198009], [41.56661988,19.98364005], [41.56812,19.98631008], [41.56862004,19.9888101], [41.56878996,19.99297008], [41.56895016,19.9966401], [41.56994988,19.99913004], [41.57193996,20.00097009], [41.5739502,20.00180007], [41.57628012,20.00280006], [41.57877996,20.00347002], [41.58228996,20.0044701], [41.58426996,20.00580003], [41.58677016,20.00696004], [41.5884402,20.00779002], [41.59060992,20.00846007], [41.59326996,20.00946006], [41.59460016,20.01096009], [41.59454436,20.01130704], [41.59443996,20.01196008], [41.59377,20.01296007], [41.59127016,20.0132901], [41.58911016,20.01346002], [41.58493992,20.0132901], [41.5761102,20.01346002], [41.55296004,20.01279006], [41.54847012,20.01313008], [41.54429988,20.01346002], [41.54139612,20.01346002], [41.54135292,20.0133999], [41.53751172,20.01416814], [41.53474584,20.01708765], [41.53182624,20.01862422], [41.52783132,20.02354128], [41.52368232,20.02722903], [41.52229956,20.03137776], [41.52383604,20.03475825], [41.52629448,20.03798502], [41.52675564,20.04167286], [41.52998232,20.04566796], [41.5322874,20.05242885], [41.53357656,20.05790805], [41.53281012,20.05893009], [41.52980988,20.06193006], [41.52615012,20.06593002], [41.52431016,20.06759007], [41.52247992,20.07042003], [41.52098988,20.07275004], [41.51948004,20.07475002], [41.51832012,20.07642006], [41.51747988,20.07841005], [41.51732004,20.08074006], [41.51715012,20.08408005], [41.51665008,20.08675008], [41.51581992,20.08858005], [41.5148202,20.09091006], [41.51315016,20.09307006], [41.51131992,20.09457009], [41.50915992,20.09541006], [41.50681992,20.09624004], [41.50398996,20.09692008], [41.50116,20.09707002], [41.49883008,20.09692008], [41.49632988,20.09607003], [41.49349992,20.09424006], [41.4913302,20.09307006], [41.48849988,20.09191005], [41.48534016,20.09074005], [41.48300988,20.08991007], [41.48051004,20.08908009], [41.47833996,20.08841004], [41.47567992,20.08825002], [41.47400988,20.0880801], [41.47201008,20.08891008], [41.47117992,20.0902401], [41.47067988,20.09274003], [41.47085016,20.09441007], [41.47117992,20.09692008], [41.47268004,20.09891007], [41.47485012,20.10057003], [41.47751016,20.10207006], [41.48101008,20.10324006], [41.48350992,20.10440007], [41.48600004,20.10540006], [41.48782992,20.10690009], [41.48916984,20.10823002], [41.4891702,20.11090005], [41.48867016,20.1125601], [41.4880002,20.11390002], [41.48733996,20.11523004], [41.48566992,20.11656006], [41.48434008,20.11723002], [41.48267004,20.1170601], [41.48101008,20.11689009], [41.47932996,20.11573008], [41.47751016,20.11473009], [41.47617996,20.11440006], [41.47517988,20.11523004], [41.47517988,20.11673007], [41.47435008,20.11839003], [41.47268004,20.11839003], [41.47151004,20.11774005], [41.46985008,20.11606002], [41.46818004,20.11440006], [41.46667992,20.11223007], [41.46485004,20.11106007], [41.46267996,20.11090005], [41.46035004,20.11090005], [41.45834988,20.11173003], [41.45668992,20.1125601], [41.45402988,20.11340007], [41.45186016,20.11440006], [41.45037012,20.11506003], [41.44853016,20.1158901], [41.44653,20.11673007], [41.44469004,20.11839003], [41.44269996,20.11923009], [41.44119984,20.11973004], [41.43920004,20.12072004], [41.43702996,20.12240007], [41.43486996,20.12389002], [41.43220992,20.12655006], [41.4300402,20.12905008], [41.42854008,20.13088005], [41.42571012,20.13405003], [41.42370996,20.13738003], [41.42253996,20.1393801], [41.4210402,20.1415401], [41.41820988,20.14471008], [41.41587996,20.1472101], [41.41371996,20.15004006], [41.41254996,20.15287002], []]',array(tuple(41.41254996, 20.15287002), tuple(41.40988992, 20.15337006), tuple(41.40722016, 20.15420004), tuple(41.40471996, 20.15437005), tuple(41.40239004, 20.15454006), tuple(41.40038988, 20.1538701), tuple(41.39906004, 20.1527001), tuple(41.39688996, 20.15104005), tuple(41.39538984, 20.1493701), tuple(41.39456004, 20.1472101), tuple(41.39355996, 20.14504002), tuple(41.39173008, 20.14288002), tuple(41.39006004, 20.14038009), tuple(41.38723008, 20.1382101), tuple(41.38522992, 20.13788007), tuple(41.38356996, 20.13855003), tuple(41.38157016, 20.1382101), tuple(41.38057008, 20.13738003), tuple(41.37990012, 20.13505002), tuple(41.37923988, 20.1327201), tuple(41.37890796, 20.13159798), tuple(41.3789454, 20.13148368), tuple(41.38103916, 20.1272958), tuple(41.38180056, 20.12596335), tuple(41.3835138, 20.12272722), tuple(41.38636932, 20.11930083), tuple(41.38674984, 20.11587435), tuple(41.38789212, 20.11073472), tuple(41.39169912, 20.10635658), tuple(41.39227044, 20.10864087), tuple(41.39417376, 20.10597588), tuple(41.39569656, 20.1029301), tuple(41.39855208, 20.10369159), tuple(41.39969436, 20.1029301), tuple(41.40312048, 20.1021687), tuple(41.40616644, 20.10007476), tuple(41.40711792, 20.09683872), tuple(41.40921204, 20.09474478), tuple(41.40997344, 20.09284119), tuple(41.40997344, 20.0901762), tuple(41.41092528, 20.08827261), tuple(41.41149624, 20.08503657), tuple(41.41187712, 20.08161018), tuple(41.41187712, 20.07951624), tuple(41.41339992, 20.07647055), tuple(41.42025288, 20.07152127), tuple(41.42405988, 20.06143236), tuple(41.42581884, 20.05027875), tuple(41.42650392, 20.04685425), tuple(41.42855844, 20.04034761), tuple(41.4289008, 20.03452587), tuple(41.42650392, 20.02973157), tuple(41.42444904, 20.02630707), tuple(41.42273688, 20.02082778), tuple(41.42273688, 20.01534858), tuple(41.42444904, 20.01021174), tuple(41.42650392, 20.00815704), tuple(41.42684628, 20.00541744), tuple(41.42684628, 20.0035701), tuple(41.42703996, 20.0035701), tuple(41.43195, 20.00291004), tuple(41.43552012, 20.00157003), tuple(41.43731004, 19.99912005), tuple(41.43819996, 19.99645002), tuple(41.43863988, 19.99310004), tuple(41.43708, 19.99108008), tuple(41.43417984, 19.98885006), tuple(41.43395988, 19.98617004), tuple(41.4346302, 19.98304002), tuple(41.43574008, 19.97925003), tuple(41.43753, 19.97615007), tuple(41.44020012, 19.97731008), tuple(41.44303008, 19.97748009), tuple(41.44552992, 19.97731008), tuple(41.44853016, 19.97698005), tuple(41.45069016, 19.9764801), tuple(41.45203008, 19.97548002), tuple(41.4535302, 19.97482005), tuple(41.45436, 19.97348004), tuple(41.45486004, 19.97132004), tuple(41.4556902, 19.96915005), tuple(41.45685984, 19.96733007), tuple(41.45851008, 19.96565004), tuple(41.4601902, 19.96500006), tuple(41.46168996, 19.96399008), tuple(41.46351984, 19.96299009), tuple(41.46518016, 19.96249005), tuple(41.46701004, 19.96116003), tuple(41.46778008, 19.96083009), tuple(41.46890004, 19.96018002), tuple(41.47259004, 19.95922008), tuple(41.47819992, 19.9579401), tuple(41.48188992, 19.95699006), tuple(41.48525988, 19.95537006), tuple(41.48733996, 19.95361002), tuple(41.48766, 19.95105006), tuple(41.48686008, 19.94832009), tuple(41.48510004, 19.94495004), tuple(41.48300988, 19.94239008), tuple(41.4798102, 19.93934007), tuple(41.47692012, 19.93726008), tuple(41.47338996, 19.93421007), tuple(41.46954012, 19.93100004), tuple(41.46666012, 19.92780009), tuple(41.46297012, 19.92571002), tuple(41.46008004, 19.92427002), tuple(41.45720004, 19.92299004), tuple(41.45463, 19.92186009), tuple(41.45286996, 19.92010005), tuple(41.45253984, 19.91850003), tuple(41.45303016, 19.91721006), tuple(41.45469012, 19.91602008), tuple(41.45769, 19.91419002), tuple(41.46035004, 19.91287008), tuple(41.46351984, 19.91052009), tuple(41.46535008, 19.90936008), tuple(41.46834996, 19.90769004), tuple(41.47050996, 19.9061901), tuple(41.47418016, 19.90336005), tuple(41.47700004, 19.90120005), tuple(41.47967988, 19.89853002), tuple(41.4858402, 19.89403002), tuple(41.48799984, 19.8928701), tuple(41.49117, 19.89187002), tuple(41.4946602, 19.89104004), tuple(41.49716004, 19.89070002), tuple(41.50000008, 19.89070002), tuple(41.50216008, 19.89087003), tuple(41.50365012, 19.89054009), tuple(41.50566, 19.89353007), tuple(41.50748988, 19.8962001), tuple(41.50949004, 19.89853002), tuple(41.51181996, 19.90103004), tuple(41.51414988, 19.90370007), tuple(41.51615004, 19.90586007), tuple(41.51765016, 19.90769004), tuple(41.51998008, 19.91119005), tuple(41.52165012, 19.91520009), tuple(41.52264984, 19.9175301), tuple(41.52348, 19.92018006), tuple(41.52381984, 19.92268008), tuple(41.52414996, 19.92535002), tuple(41.52447, 19.92818007), tuple(41.52431016, 19.93101003), tuple(41.52447, 19.93284009), tuple(41.52565008, 19.94484006), tuple(41.52647988, 19.94733009), tuple(41.52831012, 19.94967009), tuple(41.52980988, 19.95216003), tuple(41.53131, 19.95366006), tuple(41.53281012, 19.95616008), tuple(41.53480992, 19.95916005), tuple(41.53763988, 19.96182009), tuple(41.54014008, 19.96416009), tuple(41.54196996, 19.96599006), tuple(41.54447016, 19.96799004), tuple(41.54730012, 19.96966008), tuple(41.55013008, 19.97132004), tuple(41.55296004, 19.97332002), tuple(41.55629004, 19.97465004), tuple(41.55861996, 19.9764801), tuple(41.56029, 19.97815005), tuple(41.56194996, 19.9798101), tuple(41.56462008, 19.98198009), tuple(41.56661988, 19.98364005), tuple(41.56812, 19.98631008), tuple(41.56862004, 19.9888101), tuple(41.56878996, 19.99297008), tuple(41.56895016, 19.9966401), tuple(41.56994988, 19.99913004), tuple(41.57193996, 20.00097009), tuple(41.5739502, 20.00180007), tuple(41.57628012, 20.00280006), tuple(41.57877996, 20.00347002), tuple(41.58228996, 20.0044701), tuple(41.58426996, 20.00580003), tuple(41.58677016, 20.00696004), tuple(41.5884402, 20.00779002), tuple(41.59060992, 20.00846007), tuple(41.59326996, 20.00946006), tuple(41.59460016, 20.01096009), tuple(41.59454436, 20.01130704), tuple(41.59443996, 20.01196008), tuple(41.59377, 20.01296007), tuple(41.59127016, 20.0132901), tuple(41.58911016, 20.01346002), tuple(41.58493992, 20.0132901), tuple(41.5761102, 20.01346002), tuple(41.55296004, 20.01279006), tuple(41.54847012, 20.01313008), tuple(41.54429988, 20.01346002), tuple(41.54139612, 20.01346002), tuple(41.54135292, 20.0133999), tuple(41.53751172, 20.01416814), tuple(41.53474584, 20.01708765), tuple(41.53182624, 20.01862422), tuple(41.52783132, 20.02354128), tuple(41.52368232, 20.02722903), tuple(41.52229956, 20.03137776), tuple(41.52383604, 20.03475825), tuple(41.52629448, 20.03798502), tuple(41.52675564, 20.04167286), tuple(41.52998232, 20.04566796), tuple(41.5322874, 20.05242885), tuple(41.53357656, 20.05790805), tuple(41.53281012, 20.05893009), tuple(41.52980988, 20.06193006), tuple(41.52615012, 20.06593002), tuple(41.52431016, 20.06759007), tuple(41.52247992, 20.07042003), tuple(41.52098988, 20.07275004), tuple(41.51948004, 20.07475002), tuple(41.51832012, 20.07642006), tuple(41.51747988, 20.07841005), tuple(41.51732004, 20.08074006), tuple(41.51715012, 20.08408005), tuple(41.51665008, 20.08675008), tuple(41.51581992, 20.08858005), tuple(41.5148202, 20.09091006), tuple(41.51315016, 20.09307006), tuple(41.51131992, 20.09457009), tuple(41.50915992, 20.09541006), tuple(41.50681992, 20.09624004), tuple(41.50398996, 20.09692008), tuple(41.50116, 20.09707002), tuple(41.49883008, 20.09692008), tuple(41.49632988, 20.09607003), tuple(41.49349992, 20.09424006), tuple(41.4913302, 20.09307006), tuple(41.48849988, 20.09191005), tuple(41.48534016, 20.09074005), tuple(41.48300988, 20.08991007), tuple(41.48051004, 20.08908009), tuple(41.47833996, 20.08841004), tuple(41.47567992, 20.08825002), tuple(41.47400988, 20.0880801), tuple(41.47201008, 20.08891008), tuple(41.47117992, 20.0902401), tuple(41.47067988, 20.09274003), tuple(41.47085016, 20.09441007), tuple(41.47117992, 20.09692008), tuple(41.47268004, 20.09891007), tuple(41.47485012, 20.10057003), tuple(41.47751016, 20.10207006), tuple(41.48101008, 20.10324006), tuple(41.48350992, 20.10440007), tuple(41.48600004, 20.10540006), tuple(41.48782992, 20.10690009), tuple(41.48916984, 20.10823002), tuple(41.4891702, 20.11090005), tuple(41.48867016, 20.1125601), tuple(41.4880002, 20.11390002), tuple(41.48733996, 20.11523004), tuple(41.48566992, 20.11656006), tuple(41.48434008, 20.11723002), tuple(41.48267004, 20.1170601), tuple(41.48101008, 20.11689009), tuple(41.47932996, 20.11573008), tuple(41.47751016, 20.11473009), tuple(41.47617996, 20.11440006), tuple(41.47517988, 20.11523004), tuple(41.47517988, 20.11673007), tuple(41.47435008, 20.11839003), tuple(41.47268004, 20.11839003), tuple(41.47151004, 20.11774005), tuple(41.46985008, 20.11606002), tuple(41.46818004, 20.11440006), tuple(41.46667992, 20.11223007), tuple(41.46485004, 20.11106007), tuple(41.46267996, 20.11090005), tuple(41.46035004, 20.11090005), tuple(41.45834988, 20.11173003), tuple(41.45668992, 20.1125601), tuple(41.45402988, 20.11340007), tuple(41.45186016, 20.11440006), tuple(41.45037012, 20.11506003), tuple(41.44853016, 20.1158901), tuple(41.44653, 20.11673007), tuple(41.44469004, 20.11839003), tuple(41.44269996, 20.11923009), tuple(41.44119984, 20.11973004), tuple(41.43920004, 20.12072004), tuple(41.43702996, 20.12240007), tuple(41.43486996, 20.12389002), tuple(41.43220992, 20.12655006), tuple(41.4300402, 20.12905008), tuple(41.42854008, 20.13088005), tuple(41.42571012, 20.13405003), tuple(41.42370996, 20.13738003), tuple(41.42253996, 20.1393801), tuple(41.4210402, 20.1415401), tuple(41.41820988, 20.14471008), tuple(41.41587996, 20.1472101), tuple(41.41371996, 20.15004006), tuple(41.41254996, 20.15287002)))

```

#SELECT 
```
select poly,name_en  from ksa_city  where  pointInPolygon(tuple(46.622,24.7260),poly)
```


Following link i refered 

https://pachicohub.com/posts/clickhouse-geo-search/
https://github.com/ClickHouse/ClickHouse/issues/9002
https://github.com/homaily/Saudi-Arabia-Regions-Cities-and-Districts

